<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>积雪筱草</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta property="og:type" content="website">
<meta property="og:title" content="积雪筱草">
<meta property="og:url" content="https://mohuani.github.io/page/7/index.html">
<meta property="og:site_name" content="积雪筱草">
<meta property="og:locale">
<meta property="article:author" content="mohuani">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="积雪筱草" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-source-code-pro@0.0.71/index.min.css">

  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
<meta name="generator" content="Hexo 5.4.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">积雪筱草</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Suche"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Suche"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://mohuani.github.io"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main">
  
    <article id="post-NGINX/nginx的中间件架构/nginx的中间件架构-Lua开发" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2021/03/24/NGINX/nginx%E7%9A%84%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%9E%B6%E6%9E%84/nginx%E7%9A%84%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%9E%B6%E6%9E%84-Lua%E5%BC%80%E5%8F%91/" class="article-date">
  <time class="dt-published" datetime="2021-03-24T11:36:38.000Z" itemprop="datePublished">2021-03-24</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2021/03/24/NGINX/nginx%E7%9A%84%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%9E%B6%E6%9E%84/nginx%E7%9A%84%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%9E%B6%E6%9E%84-Lua%E5%BC%80%E5%8F%91/">nginx的中间件架构-Lua开发</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h4 id="Lua介绍"><a href="#Lua介绍" class="headerlink" title="Lua介绍"></a>Lua介绍</h4><p><img src="https://img-blog.csdnimg.cn/20190210160956312.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dmazI5NzUwMTk2NzE=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/20190210161027419.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dmazI5NzUwMTk2NzE=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/20190210161049801.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dmazI5NzUwMTk2NzE=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/20190210161115210.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dmazI5NzUwMTk2NzE=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/20190210161258232.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dmazI5NzUwMTk2NzE=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/20190210161322352.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dmazI5NzUwMTk2NzE=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<h4 id="nginx调用Lua指令"><a href="#nginx调用Lua指令" class="headerlink" title="nginx调用Lua指令"></a>nginx调用Lua指令</h4><p><img src="https://img-blog.csdnimg.cn/20190210163932385.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dmazI5NzUwMTk2NzE=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<h4 id="nginx-lua-api（lua调用nginx）"><a href="#nginx-lua-api（lua调用nginx）" class="headerlink" title="nginx lua api（lua调用nginx）"></a>nginx lua api（lua调用nginx）</h4><p><img src="https://img-blog.csdnimg.cn/20190210164213535.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dmazI5NzUwMTk2NzE=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://mohuani.github.io/2021/03/24/NGINX/nginx%E7%9A%84%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%9E%B6%E6%9E%84/nginx%E7%9A%84%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%9E%B6%E6%9E%84-Lua%E5%BC%80%E5%8F%91/" data-id="ckmp522hv001o33t6fzywfwdi" data-title="nginx的中间件架构-Lua开发" class="article-share-link">Teilen</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-NGINX/nginx的中间件架构/nginx的中间件架构-web静态资源" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2021/03/24/NGINX/nginx%E7%9A%84%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%9E%B6%E6%9E%84/nginx%E7%9A%84%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%9E%B6%E6%9E%84-web%E9%9D%99%E6%80%81%E8%B5%84%E6%BA%90/" class="article-date">
  <time class="dt-published" datetime="2021-03-24T11:36:38.000Z" itemprop="datePublished">2021-03-24</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2021/03/24/NGINX/nginx%E7%9A%84%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%9E%B6%E6%9E%84/nginx%E7%9A%84%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%9E%B6%E6%9E%84-web%E9%9D%99%E6%80%81%E8%B5%84%E6%BA%90/">nginx的中间件架构-web静态资源</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h4 id="http-x-forwarded-for"><a href="#http-x-forwarded-for" class="headerlink" title="http_x_forwarded_for"></a>http_x_forwarded_for</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http_x_forwarded_for &#x3D; Client IP, Proxy1 IP, Client2 IP, Client3 IP...</span><br></pre></td></tr></table></figure>
<h4 id="http-auth-basic-module配置"><a href="#http-auth-basic-module配置" class="headerlink" title="http_auth_basic_module配置"></a>http_auth_basic_module配置</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">Syntax:		auth_basic string | off;</span><br><span class="line">Default:	auth_basic off;</span><br><span class="line">Context:	http, server, location, limit_except</span><br><span class="line"> ------</span><br><span class="line">Syntax:		auth_basic_user_file file;</span><br><span class="line">Default:	—</span><br><span class="line">Context:	http, server, location, limit_except</span><br><span class="line"> ------</span><br><span class="line"> location ~ ^&#x2F;admin.html &#123;</span><br><span class="line">		root	&#x2F;opt&#x2F;app&#x2F;code;</span><br><span class="line">		auth_basic 	&quot;Auth access test ! imput your password !&quot;;</span><br><span class="line">		auth_basic_user_file	&#x2F;etc&#x2F;nginx&#x2F;auth_conf;  &#x2F;&#x2F; auth_conf文件存放已经保存的用户名和密码</span><br><span class="line">		index	index.html index.htm;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">http_auth_basic_module的局限性：</span><br><span class="line">1、用户信息依赖文件</span><br><span class="line">2、操作管理机械，效率低下</span><br><span class="line"></span><br><span class="line">解决方案：</span><br><span class="line">1、nginx结合Lua实现高效验证</span><br><span class="line">2、nginx和LDAP打通，利用nginx-auth-ladp模块</span><br></pre></td></tr></table></figure>
<h4 id="Nginx作为静态资源web服务-配置语法"><a href="#Nginx作为静态资源web服务-配置语法" class="headerlink" title="Nginx作为静态资源web服务_配置语法"></a>Nginx作为静态资源web服务_配置语法</h4><ul>
<li>   文件读取<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Syntax:		sendfile on | off;</span><br><span class="line">Default: 	sendfile off;</span><br><span class="line">Context:	http, server, location, if in location</span><br><span class="line">引读：-with-file-aio 异步文件读取</span><br></pre></td></tr></table></figure></li>
<li>tcp_nopush<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Syntax:		tcp_nopush on | off;</span><br><span class="line">Default: 	tcp_nopush off;</span><br><span class="line">Context:	http, server, location;</span><br><span class="line">作用：sendfile开启的情况下，提高网络包的传输效率</span><br></pre></td></tr></table></figure></li>
<li>tcp_nodelay</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Syntax:		tcp_nodelay on | off;</span><br><span class="line">Default: 	tcp_nodelay off;</span><br><span class="line">Context:	http, server, location;</span><br><span class="line">作用：keepalive连接下，提高网络包的额传输实时性</span><br></pre></td></tr></table></figure>
<ul>
<li>压缩</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">压缩</span><br><span class="line">Syntax:		gzip on | off;</span><br><span class="line">Default: 	gzip off;</span><br><span class="line">Context:	http, server, location, if in location;</span><br><span class="line">作用：压缩传输</span><br><span class="line">------</span><br><span class="line">压缩比</span><br><span class="line">Syntax:		gzip_comp_level level;</span><br><span class="line">Default: 	gzip_comp_level 1;</span><br><span class="line">Context:	http, server, location;</span><br><span class="line">------</span><br><span class="line">压缩版本</span><br><span class="line">Syntax:		gzip_http_version 1.0 | 1.1;</span><br><span class="line">Default: 	gzip_http_version 1.1;</span><br><span class="line">Context:	http, server, location;</span><br><span class="line">------</span><br><span class="line">拓展nginx压缩模块</span><br><span class="line">http_gzip_static_module - 预读gzip功能</span><br><span class="line">http_gunzip_module - 引用支持gunzip的压缩格式</span><br></pre></td></tr></table></figure>
<h4 id="expires"><a href="#expires" class="headerlink" title="expires"></a>expires</h4><p>添加 Cache-Control、Expires头</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Syntax:		expires [modified] time;</span><br><span class="line">					expires eposh | max | off;</span><br><span class="line">Default: 	expires off;</span><br><span class="line">Context:	http, server, location, if in location;</span><br></pre></td></tr></table></figure>
<h4 id="跨域访问"><a href="#跨域访问" class="headerlink" title="跨域访问"></a>跨域访问</h4><p>Access-Control-Allow-Origin</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Syntax:		add_header name value [always];</span><br><span class="line">Default: 	-;</span><br><span class="line">Context:	http, server, location, if in location;</span><br></pre></td></tr></table></figure>
<h4 id="防盗链-http-refer"><a href="#防盗链-http-refer" class="headerlink" title="防盗链 http_refer"></a>防盗链 http_refer</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">Syntax:		valid_referers none | block | server_names | string...;</span><br><span class="line">Default: 	-;</span><br><span class="line">Context:	http, server, location;</span><br><span class="line">------</span><br><span class="line">valid_referers none blocked 116.62.103.228;</span><br><span class="line">if ($valid_referer) &#123;</span><br><span class="line">	return 403;</span><br><span class="line">&#125;</span><br><span class="line">root &#x2F;opt&#x2F;app&#x2F;code&#x2F;images;</span><br><span class="line">示例</span><br><span class="line"></span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="article-footer">
      <a data-url="https://mohuani.github.io/2021/03/24/NGINX/nginx%E7%9A%84%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%9E%B6%E6%9E%84/nginx%E7%9A%84%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%9E%B6%E6%9E%84-web%E9%9D%99%E6%80%81%E8%B5%84%E6%BA%90/" data-id="ckmp522hw001p33t6guqi7ppu" data-title="nginx的中间件架构-web静态资源" class="article-share-link">Teilen</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-NGINX/nginx的中间件架构/nginx的中间件架构-代理服务" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2021/03/24/NGINX/nginx%E7%9A%84%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%9E%B6%E6%9E%84/nginx%E7%9A%84%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%9E%B6%E6%9E%84-%E4%BB%A3%E7%90%86%E6%9C%8D%E5%8A%A1/" class="article-date">
  <time class="dt-published" datetime="2021-03-24T11:36:38.000Z" itemprop="datePublished">2021-03-24</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2021/03/24/NGINX/nginx%E7%9A%84%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%9E%B6%E6%9E%84/nginx%E7%9A%84%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%9E%B6%E6%9E%84-%E4%BB%A3%E7%90%86%E6%9C%8D%E5%8A%A1/">nginx的中间件架构-代理服务</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h4 id="代理区别"><a href="#代理区别" class="headerlink" title="代理区别"></a>代理区别</h4><p>正向代理代理的对象是客户端<br>反向代理代理的对象是服务端</p>
<h4 id="proxy-pass"><a href="#proxy-pass" class="headerlink" title="proxy_pass"></a>proxy_pass</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">配置语法</span><br><span class="line">Syntax:		proxy_pass URL;</span><br><span class="line">Default:	-;</span><br><span class="line">Context:	location, if in location, limit_except;</span><br><span class="line">------</span><br><span class="line">http:&#x2F;&#x2F;localhost:8080&#x2F;uri&#x2F;</span><br><span class="line">https:&#x2F;&#x2F;192.168.1.1:8080&#x2F;uri&#x2F;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h4 id="缓冲区"><a href="#缓冲区" class="headerlink" title="缓冲区"></a>缓冲区</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Syntax:		proxy_buffering on | off;</span><br><span class="line">Default:	proxy_buffering on;</span><br><span class="line">Context:	http, server, location;</span><br><span class="line">拓展： proxy_buffer_size, proxy_buffers, proxy_busy_buffers_size</span><br></pre></td></tr></table></figure>
<h4 id="跳转重定向"><a href="#跳转重定向" class="headerlink" title="跳转重定向"></a>跳转重定向</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Syntax:		proxy_redirect default; proxy_redirect off; proxy_redirect redirect replacement;</span><br><span class="line">Default:	proxy_redirect ;</span><br><span class="line">Context:	server, location;</span><br></pre></td></tr></table></figure>
<h4 id="头信息"><a href="#头信息" class="headerlink" title="头信息"></a>头信息</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Syntax:		proxy_set_header field value;</span><br><span class="line">Default:	proxy_set_header Host $proxy_host;</span><br><span class="line">				proxy_set_header Connection close;</span><br><span class="line">Context:	server, location;</span><br><span class="line">扩展：proxy_hide_header, proxy_set_body</span><br></pre></td></tr></table></figure>
<h4 id="超时"><a href="#超时" class="headerlink" title="超时"></a>超时</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Syntax:		proxy_connect_timeout time;</span><br><span class="line">Default:	proxy_connect_timeout 60s;</span><br><span class="line">Context:	server, location;</span><br><span class="line">扩展：proxy_read_timeout, proxy_send_timeout  </span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="article-footer">
      <a data-url="https://mohuani.github.io/2021/03/24/NGINX/nginx%E7%9A%84%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%9E%B6%E6%9E%84/nginx%E7%9A%84%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%9E%B6%E6%9E%84-%E4%BB%A3%E7%90%86%E6%9C%8D%E5%8A%A1/" data-id="ckmp522hw001q33t65jki1s03" data-title="nginx的中间件架构-代理服务" class="article-share-link">Teilen</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-NGINX/nginx的中间件架构/nginx的中间件架构-性能优化" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2021/03/24/NGINX/nginx%E7%9A%84%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%9E%B6%E6%9E%84/nginx%E7%9A%84%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%9E%B6%E6%9E%84-%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/" class="article-date">
  <time class="dt-published" datetime="2021-03-24T11:36:38.000Z" itemprop="datePublished">2021-03-24</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2021/03/24/NGINX/nginx%E7%9A%84%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%9E%B6%E6%9E%84/nginx%E7%9A%84%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%9E%B6%E6%9E%84-%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/">nginx的中间件架构-性能优化</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h4 id="location匹配优先级"><a href="#location匹配优先级" class="headerlink" title="location匹配优先级"></a>location匹配优先级</h4><p> ~ 区分大小写，~~*不区分大小写<br><img src="https://img-blog.csdnimg.cn/20190210204325483.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dmazI5NzUwMTk2NzE=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<h4 id="try-files"><a href="#try-files" class="headerlink" title="try_files"></a>try_files</h4><p>场景：用于文件缓存<br><img src="https://img-blog.csdnimg.cn/20190210205237263.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dmazI5NzUwMTk2NzE=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<h4 id="root和alias的区别"><a href="#root和alias的区别" class="headerlink" title="root和alias的区别"></a>root和alias的区别</h4><p><img src="https://img-blog.csdnimg.cn/20190210205600926.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dmazI5NzUwMTk2NzE=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/20190210205627916.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dmazI5NzUwMTk2NzE=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<h4 id="传递用户的真实ip"><a href="#传递用户的真实ip" class="headerlink" title="传递用户的真实ip"></a>传递用户的真实ip</h4><p>在代理1处直接获取用户的ip，然后通过层层代理透传到后端<br><img src="https://img-blog.csdnimg.cn/20190210210042226.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dmazI5NzUwMTk2NzE=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<h4 id="其他常见错误"><a href="#其他常见错误" class="headerlink" title="其他常见错误"></a>其他常见错误</h4><p><img src="https://img-blog.csdnimg.cn/20190210210327967.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dmazI5NzUwMTk2NzE=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<h4 id="文件句柄优化"><a href="#文件句柄优化" class="headerlink" title="文件句柄优化"></a>文件句柄优化</h4><p><img src="https://img-blog.csdnimg.cn/20190210213216549.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dmazI5NzUwMTk2NzE=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br> 针对用户进行修改<br> <img src="https://img-blog.csdnimg.cn/20190210213355529.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dmazI5NzUwMTk2NzE=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br> 针对进程限制<br> <img src="https://img-blog.csdnimg.cn/20190210213510966.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dmazI5NzUwMTk2NzE=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<h4 id="cpu亲和绑定"><a href="#cpu亲和绑定" class="headerlink" title="cpu亲和绑定"></a>cpu亲和绑定</h4><p><img src="https://img-blog.csdnimg.cn/20190211223904157.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dmazI5NzUwMTk2NzE=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<h4 id="gzip兼容"><a href="#gzip兼容" class="headerlink" title="gzip兼容"></a>gzip兼容</h4><p><img src="https://img-blog.csdnimg.cn/20190211225553944.png" alt="在这里插入图片描述"></p>
<h4 id="安全"><a href="#安全" class="headerlink" title="安全"></a>安全</h4><p><img src="https://img-blog.csdnimg.cn/20190211230042274.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dmazI5NzUwMTk2NzE=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/20190211230546667.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dmazI5NzUwMTk2NzE=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://mohuani.github.io/2021/03/24/NGINX/nginx%E7%9A%84%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%9E%B6%E6%9E%84/nginx%E7%9A%84%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%9E%B6%E6%9E%84-%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96/" data-id="ckmp522hx001r33t6e1jifs5x" data-title="nginx的中间件架构-性能优化" class="article-share-link">Teilen</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-NGINX/nginx的中间件架构/nginx的中间件架构-负载均衡" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2021/03/24/NGINX/nginx%E7%9A%84%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%9E%B6%E6%9E%84/nginx%E7%9A%84%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%9E%B6%E6%9E%84-%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1/" class="article-date">
  <time class="dt-published" datetime="2021-03-24T11:36:38.000Z" itemprop="datePublished">2021-03-24</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2021/03/24/NGINX/nginx%E7%9A%84%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%9E%B6%E6%9E%84/nginx%E7%9A%84%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%9E%B6%E6%9E%84-%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1/">nginx的中间件架构-负载均衡</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h4 id="upstream"><a href="#upstream" class="headerlink" title="upstream"></a>upstream</h4><p><img src="https://img-blog.csdnimg.cn/20190208163713131.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dmazI5NzUwMTk2NzE=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<h4 id="负载均衡调度状态"><a href="#负载均衡调度状态" class="headerlink" title="负载均衡调度状态"></a>负载均衡调度状态</h4><p><img src="https://img-blog.csdnimg.cn/20190208163801717.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dmazI5NzUwMTk2NzE=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<h4 id="调度算法"><a href="#调度算法" class="headerlink" title="调度算法"></a>调度算法</h4><p><img src="https://img-blog.csdnimg.cn/2019020816472012.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dmazI5NzUwMTk2NzE=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<h4 id="url-hash"><a href="#url-hash" class="headerlink" title="url_hash"></a>url_hash</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Syntax:	hash key [consistent];</span><br><span class="line">Default:	-;</span><br><span class="line">Context:	upstream;</span><br><span class="line">this directive appeared in version 1.7.2</span><br></pre></td></tr></table></figure>
<p><img src="https://img-blog.csdnimg.cn/20190208165904559.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dmazI5NzUwMTk2NzE=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<h4 id="代理缓存"><a href="#代理缓存" class="headerlink" title="代理缓存"></a>代理缓存</h4><p><img src="https://img-blog.csdnimg.cn/20190208170329684.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dmazI5NzUwMTk2NzE=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<h4 id="proxy-cache"><a href="#proxy-cache" class="headerlink" title="proxy_cache"></a>proxy_cache</h4><ul>
<li>完整<br><img src="https://img-blog.csdnimg.cn/20190208170515936.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dmazI5NzUwMTk2NzE=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></li>
<li>部分</li>
</ul>
<p><img src="https://img-blog.csdnimg.cn/2019020817072612.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dmazI5NzUwMTk2NzE=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<h4 id="缓存过期周期"><a href="#缓存过期周期" class="headerlink" title="缓存过期周期"></a>缓存过期周期</h4><p><img src="https://img-blog.csdnimg.cn/20190208170807576.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dmazI5NzUwMTk2NzE=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<h4 id="缓存的维度"><a href="#缓存的维度" class="headerlink" title="缓存的维度"></a>缓存的维度</h4><p><img src="https://img-blog.csdnimg.cn/20190208170844518.png" alt="在这里插入图片描述"></p>
<h4 id="如何清除指定缓存"><a href="#如何清除指定缓存" class="headerlink" title="如何清除指定缓存"></a>如何清除指定缓存</h4><p><img src="https://img-blog.csdnimg.cn/20190208171702548.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dmazI5NzUwMTk2NzE=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<h4 id="如何让指定页面不进行缓存"><a href="#如何让指定页面不进行缓存" class="headerlink" title="如何让指定页面不进行缓存"></a>如何让指定页面不进行缓存</h4><p><img src="https://img-blog.csdnimg.cn/20190208171754843.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dmazI5NzUwMTk2NzE=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<h4 id="大文件分片请求"><a href="#大文件分片请求" class="headerlink" title="大文件分片请求"></a>大文件分片请求</h4><p><img src="https://img-blog.csdnimg.cn/20190208172159437.png" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/20190208172303566.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dmazI5NzUwMTk2NzE=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/20190208172232265.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dmazI5NzUwMTk2NzE=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<h4 id="rewrite规则"><a href="#rewrite规则" class="headerlink" title="rewrite规则"></a>rewrite规则</h4><ul>
<li>这里的规则可以用于写一个维护页面<br><img src="https://img-blog.csdnimg.cn/20190209222155472.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dmazI5NzUwMTk2NzE=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><h4 id="flag"><a href="#flag" class="headerlink" title="flag"></a>flag</h4>beak不会建立新的请求，last还会建立一个新的请求过来。向某个域名进行请求，301请求一次后再次请求不会经过服务器，302请求一次后再次请求还需求经过服务器<br><img src="https://img-blog.csdnimg.cn/20190209223509646.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dmazI5NzUwMTk2NzE=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><h4 id="rewrite规则优先级"><a href="#rewrite规则优先级" class="headerlink" title="rewrite规则优先级"></a>rewrite规则优先级</h4><img src="https://img-blog.csdnimg.cn/20190209225518691.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dmazI5NzUwMTk2NzE=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/2019020922562388.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dmazI5NzUwMTk2NzE=,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://mohuani.github.io/2021/03/24/NGINX/nginx%E7%9A%84%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%9E%B6%E6%9E%84/nginx%E7%9A%84%E4%B8%AD%E9%97%B4%E4%BB%B6%E6%9E%B6%E6%9E%84-%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1/" data-id="ckmp522hx001s33t6d3hh82vy" data-title="nginx的中间件架构-负载均衡" class="article-share-link">Teilen</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-PHP/Laravel/Laravel - DB - facade实现CURD" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2021/03/24/PHP/Laravel/Laravel%20-%20DB%20-%20facade%E5%AE%9E%E7%8E%B0CURD/" class="article-date">
  <time class="dt-published" datetime="2021-03-24T11:36:38.000Z" itemprop="datePublished">2021-03-24</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2021/03/24/PHP/Laravel/Laravel%20-%20DB%20-%20facade%E5%AE%9E%E7%8E%B0CURD/">Laravel - DB - facade实现CURD</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>新建的数据表SQL</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> IF <span class="keyword">NOT</span> <span class="keyword">EXISTS</span> students(</span><br><span class="line">    `id` <span class="type">INT</span> AUTO_INCREMENT <span class="keyword">PRIMARY</span> KEY,</span><br><span class="line">    `name` <span class="type">VARCHAR</span>(<span class="number">255</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">&#x27;&#x27;</span> COMMENT <span class="string">&#x27;姓名&#x27;</span>,</span><br><span class="line">    `age` TINYINT UNSIGNED <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="number">0</span> COMMENT <span class="string">&#x27;年龄&#x27;</span>,</span><br><span class="line">    `sex` TINYINT UNSIGNED <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="number">10</span> COMMENT <span class="string">&#x27;性别&#x27;</span>,</span><br><span class="line">    `created_at` <span class="type">INT</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="number">0</span> COMMENT <span class="string">&#x27;新增时间&#x27;</span>,</span><br><span class="line">    `updated_at` <span class="type">INT</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="number">0</span> COMMENT <span class="string">&#x27;修改时间&#x27;</span></span><br><span class="line">)ENGINE<span class="operator">=</span>InnoDB <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>UTF8 AUTO_INCREMENT<span class="operator">=</span><span class="number">1001</span> COMMENT<span class="operator">=</span><span class="string">&#x27;学生表&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p>在控制器中实现基本的CURD</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">App</span>\<span class="title">Http</span>\<span class="title">Controllers</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">use</span> <span class="title">Illuminate</span>\<span class="title">Support</span>\<span class="title">Facades</span>\<span class="title">DB</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">StudentController</span> <span class="keyword">extends</span> <span class="title">Controller</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">test1</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">	    <span class="comment">//查询操作</span></span><br><span class="line">        <span class="variable">$student</span> = DB::select(<span class="string">&#x27;select * from student&#x27;</span>);</span><br><span class="line">        var_dump(<span class="variable">$student</span>);</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//插入操作</span></span><br><span class="line">        <span class="variable">$bool</span> = DB::insert(<span class="string">&#x27;insert into student (name, age) values (?, ?)&#x27;</span>,</span><br><span class="line">            [<span class="string">&#x27;imooc&#x27;</span>, <span class="number">19</span>]);</span><br><span class="line">        var_dump(<span class="variable">$bool</span>);</span><br><span class="line">		</span><br><span class="line">		<span class="comment">//更新操作</span></span><br><span class="line">        <span class="variable">$num</span> = DB::update(<span class="string">&#x27;update student set age = ? where name = ?&#x27;</span>,</span><br><span class="line">            [<span class="number">20</span>, <span class="string">&#x27;wfk&#x27;</span>]);</span><br><span class="line">        var_dump(<span class="variable">$num</span>);</span><br><span class="line"></span><br><span class="line">		<span class="comment">//查询操作</span></span><br><span class="line">        <span class="variable">$student</span> = DB::select(<span class="string">&#x27;select * from student where id &gt; ?&#x27;</span>,</span><br><span class="line">            [<span class="number">1001</span>]);</span><br><span class="line">        var_dump(<span class="variable">$student</span>);</span><br><span class="line">        dd(<span class="variable">$student</span>);</span><br><span class="line"></span><br><span class="line">		<span class="comment">//删除操作</span></span><br><span class="line">        <span class="variable">$num</span> = DB::delete(<span class="string">&#x27;delete from student where id &gt; ?&#x27;</span>, [<span class="number">1001</span>]);</span><br><span class="line">        var_dump(<span class="variable">$num</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="article-footer">
      <a data-url="https://mohuani.github.io/2021/03/24/PHP/Laravel/Laravel%20-%20DB%20-%20facade%E5%AE%9E%E7%8E%B0CURD/" data-id="ckmp522hy001t33t69pc72muj" data-title="Laravel - DB - facade实现CURD" class="article-share-link">Teilen</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-PHP/Laravel/Laravel - Eloquent ORM数据处理" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2021/03/24/PHP/Laravel/Laravel%20-%20Eloquent%20ORM%E6%95%B0%E6%8D%AE%E5%A4%84%E7%90%86/" class="article-date">
  <time class="dt-published" datetime="2021-03-24T11:36:38.000Z" itemprop="datePublished">2021-03-24</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2021/03/24/PHP/Laravel/Laravel%20-%20Eloquent%20ORM%E6%95%B0%E6%8D%AE%E5%A4%84%E7%90%86/">Laravel - Eloquent ORM数据处理</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>#Laravel - Eloquent ORM数据处理</p>
<ul>
<li>将数据库和Model进行绑定</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">namespace App;</span><br><span class="line"></span><br><span class="line">use Illuminate\Database\Eloquent\Model;</span><br><span class="line"></span><br><span class="line">class Student extends Model</span><br><span class="line">&#123;</span><br><span class="line">    &#x2F;&#x2F; 指定表名</span><br><span class="line">    protected $table &#x3D; &#39;student&#39;;</span><br><span class="line"></span><br><span class="line">    &#x2F;&#x2F; 指定id</span><br><span class="line">    protected $primaryKey &#x3D; &#39;id&#39;;</span><br><span class="line"></span><br><span class="line">    &#x2F;&#x2F; 指定允许批量赋值的字段</span><br><span class="line">    protected $fillable &#x3D; [&#39;name&#39;, &#39;age&#39;];</span><br><span class="line"></span><br><span class="line">    &#x2F;&#x2F; 指定不允许批量赋值的字段</span><br><span class="line">    protected $guarded &#x3D; [];</span><br><span class="line"></span><br><span class="line">    &#x2F;&#x2F;自动维护时间戳</span><br><span class="line">    public $timestamp &#x3D; true;</span><br><span class="line"></span><br><span class="line">    protected function getDateFormat()</span><br><span class="line">    &#123;</span><br><span class="line">        return time();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    protected function asDateTime($val)</span><br><span class="line">    &#123;</span><br><span class="line">        return $val;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p> <strong>1. 使用模型查询数据</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">public function orm1()</span><br><span class="line">&#123;</span><br><span class="line">    &#x2F;&#x2F;all()</span><br><span class="line">    $student &#x3D; Student::all();</span><br><span class="line">    dd($student);</span><br><span class="line"></span><br><span class="line">    &#x2F;&#x2F;find()</span><br><span class="line">    Student::find(1001);</span><br><span class="line">    dd($student);</span><br><span class="line"></span><br><span class="line">    &#x2F;&#x2F;findOrFail()</span><br><span class="line">    $student &#x3D; Student::findOrFail(1001);</span><br><span class="line">    dd($student);</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>2.使用模型新增数据</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">public function orm2()</span><br><span class="line">&#123;</span><br><span class="line">    &#x2F;&#x2F;使用模型新增数据</span><br><span class="line">    $student &#x3D; new Student();</span><br><span class="line">    $student-&gt;name &#x3D; &#39;sean1&#39;;</span><br><span class="line">    $student-&gt;age &#x3D; 19;</span><br><span class="line">    $bool &#x3D; $student-&gt;save();</span><br><span class="line">    dd($bool);</span><br><span class="line"></span><br><span class="line">    $student &#x3D; Student::find(1012);</span><br><span class="line">    echo $student-&gt;created_at;</span><br><span class="line">    echo date(&#39;Y-m-d H:i:s&#39;);</span><br><span class="line"></span><br><span class="line">    &#x2F;&#x2F;使用模型的Create()方法新增数据</span><br><span class="line">    $student &#x3D; Student::create(</span><br><span class="line">        [&#39;name&#39; &#x3D;&gt; &#39;imooc&#39;, &#39;age&#39; &#x3D;&gt; 18]</span><br><span class="line">    );</span><br><span class="line">    dd($student);</span><br><span class="line"></span><br><span class="line">    &#x2F;&#x2F;firstOrCreate()</span><br><span class="line">    $student &#x3D; Student::firstOrCreate(</span><br><span class="line">        [&#39;name&#39; &#x3D;&gt; &#39;imoocs&#39;, &#39;age&#39; &#x3D;&gt; 18]</span><br><span class="line">    );</span><br><span class="line">    dd($student);</span><br><span class="line"></span><br><span class="line">    &#x2F;&#x2F;firstOrNew()</span><br><span class="line">    $student &#x3D; Student::firstOrNew(</span><br><span class="line">        [&#39;name&#39; &#x3D;&gt; &#39;imoocss&#39;, &#39;age&#39; &#x3D;&gt; 18]</span><br><span class="line">    );</span><br><span class="line">    $bool &#x3D; $student-&gt;save();</span><br><span class="line">    dd($student);</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>3.通过模型更新数据</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">public function orm3()</span><br><span class="line">&#123;</span><br><span class="line">    &#x2F;&#x2F;通过模型更新数据</span><br><span class="line">    $student &#x3D; Student::find(1014);</span><br><span class="line">    $student-&gt;name &#x3D; &#39;kitty&#39;;</span><br><span class="line">    $bool &#x3D; $student-&gt;save();</span><br><span class="line">    var_dump($bool);</span><br><span class="line"></span><br><span class="line">    $sum &#x3D; Student::where(&#39;id&#39;, &#39;&gt;&#39;, 1013)-&gt;update(</span><br><span class="line">        [&#39;age&#39; &#x3D;&gt; 32]</span><br><span class="line">    );</span><br><span class="line">    var_dump($sum);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>4.通过模型删除数据</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">public function orm4()</span><br><span class="line">&#123;</span><br><span class="line">    &#x2F;&#x2F;通过主键查找</span><br><span class="line">    $bool &#x3D; Student::find(1005)-&gt;delete();</span><br><span class="line">    dd($bool);</span><br><span class="line"></span><br><span class="line">    &#x2F;&#x2F;通过主键删除税数据</span><br><span class="line">    $num &#x3D; Student::detroy(1013);</span><br><span class="line">    $num &#x3D; Student::detroy(1013, 1014);</span><br><span class="line">    $num &#x3D; Student::detroy([1013,1014]);</span><br><span class="line">    var_dump($num);</span><br><span class="line"></span><br><span class="line">    &#x2F;&#x2F;通过where条件删除数据</span><br><span class="line">    $num &#x3D; Student::where(&#39;id&#39;, &#39;&gt;&#39;, &#39;1007&#39;)-&gt;delete();</span><br><span class="line">    var_dump($num);</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="article-footer">
      <a data-url="https://mohuani.github.io/2021/03/24/PHP/Laravel/Laravel%20-%20Eloquent%20ORM%E6%95%B0%E6%8D%AE%E5%A4%84%E7%90%86/" data-id="ckmp522hz001u33t672gh6wvu" data-title="Laravel - Eloquent ORM数据处理" class="article-share-link">Teilen</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-PHP/Laravel/Laravel collecte break continue" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2021/03/24/PHP/Laravel/Laravel%20collecte%20break%20continue/" class="article-date">
  <time class="dt-published" datetime="2021-03-24T11:36:38.000Z" itemprop="datePublished">2021-03-24</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2021/03/24/PHP/Laravel/Laravel%20collecte%20break%20continue/">Laravel collecte break continue</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <hr>
<h2 id="typora-root-url-images"><a href="#typora-root-url-images" class="headerlink" title="typora-root-url: ../images"></a>typora-root-url: ../images</h2><p><a target="_blank" rel="noopener" href="https://editor.csdn.net/md/?articleId=114985626">Laravel collecte break continue</a></p>
<blockquote>
<p>背景： Laravel框架中循环我们都推荐使用 collecte 进行循环，但是如果我们想要在循环中<br>break 或者 continue，直接break或者continue，语法层面会直接报错，那么怎么才能实现上述所要的效果呢。其实在循环中 <code>return</code>的效果就类似与<code>break</code>，而 <code>return false</code> 的效果就类似于 <code>continue</code></p>
</blockquote>
<p>测试demo如下</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">use</span> <span class="title">Illuminate</span>\<span class="title">Database</span>\<span class="title">Seeder</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MohuaniSeeder</span> <span class="keyword">extends</span> <span class="title">Seeder</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Run the database seeds.</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> void</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">run</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;collectContinue();</span><br><span class="line">        <span class="keyword">$this</span>-&gt;command-&gt;info(<span class="string">&quot;--------------&quot;</span>);</span><br><span class="line">        <span class="keyword">$this</span>-&gt;collectBreak();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">collectContinue</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$arrList</span> = [</span><br><span class="line">            <span class="string">&quot;a&quot;</span> =&gt; <span class="string">&quot;A&quot;</span>,</span><br><span class="line">            <span class="string">&quot;b&quot;</span> =&gt; <span class="string">&quot;B&quot;</span>,</span><br><span class="line">            <span class="string">&quot;c&quot;</span> =&gt; <span class="string">&quot;C&quot;</span>,</span><br><span class="line">        ];</span><br><span class="line"></span><br><span class="line">        <span class="keyword">$this</span>-&gt;command-&gt;info(<span class="number">111</span>);</span><br><span class="line">        collect(<span class="variable">$arrList</span>)-&gt;each(<span class="function"><span class="keyword">function</span> (<span class="params"><span class="variable">$arr</span></span>) </span>&#123;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;command-&gt;info(<span class="number">222</span>);</span><br><span class="line">            <span class="keyword">if</span> (<span class="variable">$arr</span> == <span class="string">&quot;b&quot;</span>) &#123;</span><br><span class="line">                <span class="keyword">$this</span>-&gt;command-&gt;info(<span class="number">333</span>);</span><br><span class="line">                <span class="keyword">return</span>; <span class="comment">// 跳出本次循环，类似continue</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">$this</span>-&gt;command-&gt;info(<span class="number">444</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">collectBreak</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$arrList</span> = [</span><br><span class="line">            <span class="string">&quot;a&quot;</span> =&gt; <span class="string">&quot;A&quot;</span>,</span><br><span class="line">            <span class="string">&quot;b&quot;</span> =&gt; <span class="string">&quot;B&quot;</span>,</span><br><span class="line">            <span class="string">&quot;c&quot;</span> =&gt; <span class="string">&quot;C&quot;</span>,</span><br><span class="line">        ];</span><br><span class="line"></span><br><span class="line">        <span class="keyword">$this</span>-&gt;command-&gt;info(<span class="number">111</span>);</span><br><span class="line">        collect(<span class="variable">$arrList</span>)-&gt;each(<span class="function"><span class="keyword">function</span> (<span class="params"><span class="variable">$arr</span></span>) </span>&#123;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;command-&gt;info(<span class="number">222</span>);</span><br><span class="line">            <span class="keyword">if</span> (<span class="variable">$arr</span> == <span class="string">&quot;b&quot;</span>) &#123;</span><br><span class="line">                <span class="keyword">$this</span>-&gt;command-&gt;info(<span class="number">333</span>);</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>; <span class="comment">// 跳出所有循环，类似break</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">$this</span>-&gt;command-&gt;info(<span class="number">444</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>运行seeder</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">php artisan  db:seed  --class=MohuaniSeeder</span><br></pre></td></tr></table></figure>

<p>结果：</p>
<p><img src="../images/20210318194853117.png" alt="20210318194853117"></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://mohuani.github.io/2021/03/24/PHP/Laravel/Laravel%20collecte%20break%20continue/" data-id="ckmp522hz001v33t60lgt76ay" data-title="Laravel collecte break continue" class="article-share-link">Teilen</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-PHP/Laravel/Laravel 查询构造器的使用（一）" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2021/03/24/PHP/Laravel/Laravel%20%E6%9F%A5%E8%AF%A2%E6%9E%84%E9%80%A0%E5%99%A8%E7%9A%84%E4%BD%BF%E7%94%A8%EF%BC%88%E4%B8%80%EF%BC%89/" class="article-date">
  <time class="dt-published" datetime="2021-03-24T11:36:38.000Z" itemprop="datePublished">2021-03-24</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2021/03/24/PHP/Laravel/Laravel%20%E6%9F%A5%E8%AF%A2%E6%9E%84%E9%80%A0%E5%99%A8%E7%9A%84%E4%BD%BF%E7%94%A8%EF%BC%88%E4%B8%80%EF%BC%89/">Laravel 查询构造器的使用（一）</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>使用查询构造器对数据库的 增 - 删 - 改 操作</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//使用查询构造器新增数据</span></span><br><span class="line">   <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">query1</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">   </span>&#123;</span><br><span class="line">       <span class="variable">$bool</span> = DB::table(<span class="string">&#x27;student&#x27;</span>)-&gt;insert(</span><br><span class="line">           [<span class="string">&#x27;name&#x27;</span> =&gt; <span class="string">&#x27;mohuani&#x27;</span>, <span class="string">&#x27;age&#x27;</span> =&gt; <span class="number">19</span>]</span><br><span class="line">       );</span><br><span class="line">       var_dump(<span class="variable">$bool</span>);</span><br><span class="line"></span><br><span class="line">       <span class="variable">$id</span> = DB::table(<span class="string">&#x27;student&#x27;</span>)-&gt;insertGetId(</span><br><span class="line">           [<span class="string">&#x27;name&#x27;</span> =&gt; <span class="string">&#x27;sean&#x27;</span>, <span class="string">&#x27;age&#x27;</span> =&gt; <span class="number">18</span>]</span><br><span class="line">       );</span><br><span class="line">       var_dump(<span class="variable">$id</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">       <span class="variable">$id</span> = DB::table(<span class="string">&#x27;student&#x27;</span>)-&gt;insert([</span><br><span class="line">           [<span class="string">&#x27;name&#x27;</span> =&gt; <span class="string">&#x27;name1&#x27;</span>, <span class="string">&#x27;age&#x27;</span> =&gt; <span class="number">21</span>],</span><br><span class="line">           [<span class="string">&#x27;name&#x27;</span> =&gt; <span class="string">&#x27;name2&#x27;</span>, <span class="string">&#x27;age&#x27;</span> =&gt; <span class="number">22</span>]</span><br><span class="line">       ]);</span><br><span class="line">       var_dump(<span class="variable">$id</span>);</span><br><span class="line"></span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">   <span class="comment">//使用查询构造器更新数据</span></span><br><span class="line">   <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">query2</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">   </span>&#123;</span><br><span class="line">       <span class="variable">$sum</span> = DB::table(<span class="string">&#x27;student&#x27;</span>)</span><br><span class="line">           -&gt;where(<span class="string">&#x27;id&#x27;</span>, <span class="number">1001</span>)</span><br><span class="line">           -&gt;update([<span class="string">&#x27;age&#x27;</span> =&gt; <span class="number">30</span>]);</span><br><span class="line">       var_dump(<span class="variable">$sum</span>);</span><br><span class="line"></span><br><span class="line">       <span class="comment">//实现自增</span></span><br><span class="line">       <span class="variable">$sum</span> = DB::table(<span class="string">&#x27;student&#x27;</span>)-&gt;increment(<span class="string">&#x27;age&#x27;</span>);</span><br><span class="line">       <span class="variable">$sum</span> = DB::table(<span class="string">&#x27;student&#x27;</span>)-&gt;increment(<span class="string">&#x27;age&#x27;</span>, <span class="number">3</span>);</span><br><span class="line"></span><br><span class="line">       <span class="comment">//实现自减</span></span><br><span class="line">       <span class="variable">$sum</span> = DB::table(<span class="string">&#x27;student&#x27;</span>)-&gt;decrement(<span class="string">&#x27;age&#x27;</span>);</span><br><span class="line">       <span class="variable">$sum</span> = DB::table(<span class="string">&#x27;student&#x27;</span>)-&gt;decrement(<span class="string">&#x27;age&#x27;</span>, <span class="number">3</span>);</span><br><span class="line"></span><br><span class="line">       <span class="comment">//使用where条件更新</span></span><br><span class="line">       <span class="variable">$num</span> = DB::table(<span class="string">&#x27;student&#x27;</span>)</span><br><span class="line">           -&gt;where(<span class="string">&#x27;id&#x27;</span>, <span class="number">1004</span>)</span><br><span class="line">           -&gt;decrement(<span class="string">&#x27;age&#x27;</span>, <span class="number">3</span>);</span><br><span class="line">       var_dump(<span class="variable">$num</span>);</span><br><span class="line"></span><br><span class="line">       <span class="comment">//使用where条件更新</span></span><br><span class="line">       <span class="variable">$num</span> = DB::table(<span class="string">&#x27;student&#x27;</span>)</span><br><span class="line">           -&gt;where(<span class="string">&#x27;id&#x27;</span>, <span class="number">1004</span>)</span><br><span class="line">           -&gt;decrement(<span class="string">&#x27;age&#x27;</span>, <span class="number">3</span>, [<span class="string">&#x27;name&#x27;</span> =&gt; <span class="string">&#x27;iimooc&#x27;</span>]);</span><br><span class="line">       var_dump(<span class="variable">$num</span>);</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="comment">//使用查询构造器删除数据</span></span><br><span class="line">   <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">query3</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">   </span>&#123;</span><br><span class="line">       <span class="variable">$num</span> = DB::table(<span class="string">&#x27;student&#x27;</span>)</span><br><span class="line">           -&gt;where(<span class="string">&#x27;id&#x27;</span>,<span class="number">1008</span>)</span><br><span class="line">           -&gt;delete();</span><br><span class="line">       var_dump(<span class="variable">$num</span>);</span><br><span class="line"></span><br><span class="line">       <span class="variable">$num</span> = DB::table(<span class="string">&#x27;student&#x27;</span>)</span><br><span class="line">           -&gt;where(<span class="string">&#x27;id&#x27;</span>, <span class="string">&#x27;&gt;=&#x27;</span>, <span class="number">1008</span>)</span><br><span class="line">           -&gt;delete();</span><br><span class="line">       var_dump(<span class="variable">$num</span>);</span><br><span class="line"></span><br><span class="line">       DB::table(<span class="string">&#x27;student&#x27;</span>)-&gt;truncate();</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="article-footer">
      <a data-url="https://mohuani.github.io/2021/03/24/PHP/Laravel/Laravel%20%E6%9F%A5%E8%AF%A2%E6%9E%84%E9%80%A0%E5%99%A8%E7%9A%84%E4%BD%BF%E7%94%A8%EF%BC%88%E4%B8%80%EF%BC%89/" data-id="ckmp522i0001w33t6akj7hq6l" data-title="Laravel 查询构造器的使用（一）" class="article-share-link">Teilen</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-PHP/Laravel/Laravel 查询构造器的使用（三）" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2021/03/24/PHP/Laravel/Laravel%20%E6%9F%A5%E8%AF%A2%E6%9E%84%E9%80%A0%E5%99%A8%E7%9A%84%E4%BD%BF%E7%94%A8%EF%BC%88%E4%B8%89%EF%BC%89/" class="article-date">
  <time class="dt-published" datetime="2021-03-24T11:36:38.000Z" itemprop="datePublished">2021-03-24</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2021/03/24/PHP/Laravel/Laravel%20%E6%9F%A5%E8%AF%A2%E6%9E%84%E9%80%A0%E5%99%A8%E7%9A%84%E4%BD%BF%E7%94%A8%EF%BC%88%E4%B8%89%EF%BC%89/">Laravel 查询构造器的使用（三）</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>查询构造器中的构造函数</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//聚合函数</span></span><br><span class="line">   <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">query5</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">   </span>&#123;</span><br><span class="line">       <span class="variable">$num</span> = DB::table(<span class="string">&#x27;student&#x27;</span>)-&gt;count();</span><br><span class="line">       var_dump(<span class="variable">$num</span>);</span><br><span class="line"></span><br><span class="line">       <span class="variable">$max</span> = DB::table(<span class="string">&#x27;student&#x27;</span>)-&gt;max(<span class="string">&#x27;age&#x27;</span>);</span><br><span class="line">       var_dump(<span class="variable">$max</span>);</span><br><span class="line"></span><br><span class="line">       <span class="variable">$min</span> = DB::table(<span class="string">&#x27;student&#x27;</span>)-&gt;min(<span class="string">&#x27;age&#x27;</span>);</span><br><span class="line">       var_dump(<span class="variable">$min</span>);</span><br><span class="line"></span><br><span class="line">       <span class="variable">$avg</span> = DB::table(<span class="string">&#x27;student&#x27;</span>)-&gt;avg(<span class="string">&#x27;age&#x27;</span>);</span><br><span class="line">       var_dump(<span class="variable">$avg</span>);</span><br><span class="line"></span><br><span class="line">       <span class="variable">$sum</span> = DB::table(<span class="string">&#x27;student&#x27;</span>)-&gt;sum(<span class="string">&#x27;age&#x27;</span>);</span><br><span class="line">       var_dump(<span class="variable">$sum</span>);</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="article-footer">
      <a data-url="https://mohuani.github.io/2021/03/24/PHP/Laravel/Laravel%20%E6%9F%A5%E8%AF%A2%E6%9E%84%E9%80%A0%E5%99%A8%E7%9A%84%E4%BD%BF%E7%94%A8%EF%BC%88%E4%B8%89%EF%BC%89/" data-id="ckmp522i0001x33t65ztrhjc1" data-title="Laravel 查询构造器的使用（三）" class="article-share-link">Teilen</a>
      
      
      
    </footer>
  </div>
  
</article>



  


  <nav id="page-nav">
    
    <a class="extend prev" rel="prev" href="/page/6/">&laquo; zurück</a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/5/">5</a><a class="page-number" href="/page/6/">6</a><span class="page-number current">7</span><a class="page-number" href="/page/8/">8</a><a class="page-number" href="/page/9/">9</a><a class="page-number" href="/page/10/">10</a><a class="extend next" rel="next" href="/page/8/">weiter &raquo;</a>
  </nav>

</section>
        
          <aside id="sidebar">
  
    

  
    

  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archiv</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/03/">March 2021</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">letzter Beitrag</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2021/03/24/Golang/5G%E6%97%B6%E4%BB%A3Vlog%E5%8E%9F%E5%9E%8B%E7%B3%BB%E7%BB%9F%E5%BC%80%E5%8F%91/">5G时代Vlog原型系统开发</a>
          </li>
        
          <li>
            <a href="/2021/03/24/Golang/GO%E8%AF%AD%E8%A8%80%E5%85%A8%E6%A0%88%E5%B7%A5%E7%A8%8B%E5%B8%88/Google%E8%B5%84%E6%B7%B1%E5%B7%A5%E7%A8%8B%E5%B8%88%E6%B7%B1%E5%BA%A6%E8%AE%B2%E8%A7%A3Go%E8%AF%AD%E8%A8%8011-http%E5%8F%8A%E5%85%B6%E4%BB%96%E6%A0%87%E5%87%86%E5%BA%93/">Google资深工程师深度讲解Go语言11-http及其他标准库</a>
          </li>
        
          <li>
            <a href="/2021/03/24/Git/gitignore%E6%96%87%E4%BB%B6%E4%B8%8D%E7%94%9F%E6%95%88/">gitignore文件不生效</a>
          </li>
        
          <li>
            <a href="/2021/03/24/Git/Git%20push%E5%87%BA%E9%94%99/">Git push出错</a>
          </li>
        
          <li>
            <a href="/2021/03/24/Golang/Beego/">Beego</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2021 mohuani<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/js/jquery-3.4.1.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
</body>
</html>